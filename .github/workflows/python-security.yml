# Workflow regarding python security scanning.
name: Python Security

on:
  push:
    branches:
      # Run on our main branch
      - main
    paths:
      - example-python/**
  pull_request:
    # Run for any pull requests
    branches:
      - main
jobs:
  # https://github.com/marketplace/actions/anchore-container-scan
  security:
    runs-on: ubuntu-latest
    permissions:
      # required for bandit
      security-events: write
    steps:
      - uses: actions/checkout@v4  # Checkout the current branch/merge state
      - name: Grype Scan
        uses: anchore/scan-action@v3
        with:
          path: example-python
      - name: Pip Audit
        uses: pypa/gh-action-pip-audit@v1.1.0
        with:
          inputs: example-python
      - name: Bandit Analysis
        uses: PyCQA/bandit-action@v1
        with:
          targets: example-python
          configfile: example-python/pyproject.toml
